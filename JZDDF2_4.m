%矩阵迭代法
%13个自由度的条件
clc,clear all,close all
%输入质量矩阵
M(1,1)=35.52;
M(2,2)=18.92;M(3,3)=18.92;M(4,4)=18.92;M(5,5)=18.92;
M(6,6)=18.92;M(7,7)=18.92;M(8,8)=18.92;M(9,9)=18.92;
M(10,10)=6.35;M(11,11)=312.87;M(12,12)=10.77;M(13,13)=157.05;
%输入刚度矩阵
K(1,1)=10e8*1/7.46;K(1,2)=-10e8*1/7.46;
K(2,1)=-10e8*1/7.46;K(2,2)=10e8*(1/7.46+1/9.16);K(2,3)=-10e8*1/9.16;
K(3,2)=-10e8*1/9.16;K(3,3)=10e8*(1/9.16+1/9.16);K(3,4)=-10e8*1/9.16;
K(4,3)=-10e8*1/9.16;K(4,4)=10e8*(1/9.16+1/9.16);K(4,5)=-10e8*1/9.16;
K(5,4)=-10e8*1/9.16;K(5,5)=10e8*(1/9.16+1/9.16);K(5,6)=-10e8*1/9.16;
K(6,5)=-10e8*1/9.16;K(6,6)=10e8*(1/9.16+1/9.16);K(6,7)=-10e8*1/9.16;
K(7,6)=-10e8*1/9.16;K(7,7)=10e8*(1/9.16+1/9.16);K(7,8)=-10e8*1/9.16;
K(8,7)=-10e8*1/9.16;K(8,8)=10e8*(1/9.16+1/9.16);K(8,9)=-10e8*1/9.16;
K(9,8)=-10e8*1/9.16;K(9,9)=10e8*(1/9.16+1/6.88);K(9,10)=-10e8*1/6.88;
K(10,9)=-10e8*1/6.88;K(10,10)=10e8*(1/6.88+1/7.04);K(10,11)=-10e8*1/7.04;
K(11,10)=-10e8*1/7.04;K(11,11)=10e8*(1/7.04+1/25.51);K(11,12)=-10e8*1/25.51;
K(12,11)=-10e8*1/25.51;K(12,12)=10e8*(1/25.51+1/926.56);K(12,13)=-10e8*1/926.56;
K(13,12)=-10e8*1/926.56;K(13,13)=10e8*1/926.56;
%计算特征值与特征向量
D=inv(K+1*M)*M;
A=ones(13,1);
for i=1:8
    pp0=0;
    i
    B=D*A;
    pp=1.0/B(1);
    A=B/B(1);
    while abs((pp-pp0)/pp)>1.e-10
        pp0=pp;
        B=D*A;
        pp=1.0/B(1);
        A=B*pp;
    end
      if (pp-1)>0
       f=sqrt(pp-1)/2/pi;
       A=vpa(A,5);f=vpa(f,5);
       disp(A)
       disp(f)
      else
         f=0
      end
    D=D-(A*A'*M)/(A'*M*A*pp);
end